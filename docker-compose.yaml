services:
  server:
    build:
      context: ./server
      dockerfile: ../Dockerfile
      args:
        - PROJECT=server
    ports:
      - "20001:8080"

  proxy:
    build:
      context: ./proxy
      dockerfile: ../Dockerfile
      args:
        - PROJECT=proxy
    depends_on:
      - server
    ports:
      - "20002:8080"

  client:
    build:
      context: ./client
      dockerfile: ../Dockerfile
      args:
        - PROJECT=client
    depends_on:
      - proxy
    command: --addr http://proxy
